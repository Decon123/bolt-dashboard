<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Bolt Dashboard</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        margin-top: 50px;
      }
      #boltCount {
        font-size: 2em;
        font-weight: bold;
        color: black; /* Default color */
      }
      .low-bolts {
        color: red;
      }
      .alert {
        display: none;
        font-size: 1.2em;
        color: red;
        font-weight: bold;
        margin-top: 10px;
      }
    </style>
  </head>
  <body>
    <h1>Bolt Dashboard</h1>
    <p><strong>Item Code:</strong> <span id="itemCode">BOLT123</span></p>
    <p>
      <strong>Bolt Count:</strong> <span id="boltCount">50</span> /
      <span id="totalCount">100</span>
    </p>
    <p id="alertMessage" class="alert">
      ‚ö†Ô∏è Refill Required! Bolt count is below 10.
    </p>
    <p id="errorMessage" class="alert" style="display: none">
      ‚ùå Invalid bolt count! Must be between 0 and total.
    </p>

    <script>
      const socket = io();

      socket.on("connect", function () {
        console.log("‚úÖ Connected to WebSocket server");
      });

      socket.on("updateBoltData", function (data) {
        console.log("üîÑ Data received:", data);

        document.getElementById("itemCode").textContent = data.itemCode;
        document.getElementById("boltCount").textContent = data.currentCount;
        document.getElementById("totalCount").textContent = data.totalCount;

        const countElement = document.getElementById("boltCount");
        const alertMessage = document.getElementById("alertMessage");
        const errorMessage = document.getElementById("errorMessage");

        // Check for valid bolt count
        if (data.currentCount < 0 || data.currentCount > data.totalCount) {
          errorMessage.style.display = "block";
          return;
        } else {
          errorMessage.style.display = "none";
        }

        // Change color and show alert if count is low
        if (data.currentCount < 10) {
          countElement.classList.add("low-bolts");
          alertMessage.style.display = "block";
        } else {
          countElement.classList.remove("low-bolts");
          alertMessage.style.display = "none";
        }
      });

      socket.on("disconnect", function () {
        console.log("‚ùå Disconnected from WebSocket server");
      });
    </script>
  </body>
</html>
